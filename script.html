<!DOCTYPE html>

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="styles.css">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link
        href="https://fonts.googleapis.com/css2?family=Roboto+Mono:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;1,100;1,200;1,300;1,400;1,500;1,600;1,700&display=swap"
        rel="stylesheet">
</head>

    <body id="home">
        <header>
            <div class="navBackground">
                <div id="pageTitle">
                    <div style="color: yellow">
                        Desktop-Engineering<span style="color: white"> with</span><span style="color: chartreuse">
                            $PowerShell</span></div>
                </div>
                <div id="navbar">
                    <ul class="nav">
                        <div class="vertical-menu">
                            <a href="./index.html" class="nav-link">Home</a>
                            <a href="./articles.html" class="nav-link">Guides</a>
                            <a href="./contact.html" class="nav-link">Contact</a>
                          </div>
    
                    </ul>
                </div>
    
            </div>

    <section class="container">
        <div class="articleSpacing">
            <div class="headline">Calling Scripts</div>

            <p> Now that we have all of our scripts written, we need to make sure that they will actually run. If we are running these as Scripts from the Deployment Workbench, Windows should give the script the required permissions. However, if we are running
                these scripts as Applications, or on machines that have already been deployed, we're going to have to make sure that the scripts are elevated properly. To do this, open the Application on the Workbench, go to the 'Quiet Install Command' line under 'Details', 
                and call your script with</p>
        
                <div>
                    <code>powershell.exe -ExecutionPolicy Bypass -File ./script.ps1</code>
                </div>.<br>
        
            <p> The Execution Policy is restricted by default, so you'll get an error message if you try to call the script directly. Another problem that we may encounter
                is that the script may run without administrator privileges. We can include a line in each of our scripts, which will check if the session is running as administrator, and if not, open a new window and run the rest of the script as administrator:</p>

                <div class="code_block">
                    <code>if (-NOT ([Security.Principal.WindowsPrincipal][Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole([Security.Principal.WindowsBuiltInRole] "Administrator"))</code>
                </div>
    </div>
</section>

<footer>
    <div>
        <a href="./author.html" class="footer-link">About the Author</a>
    </div>
</footer>

</body>